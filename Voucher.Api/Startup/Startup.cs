using AutoMapper;
using Voucher.Api.ServiceRepository;
using Voucher.Api.ServiceRepository.Extensions;
using Voucher.Application.ServiceStack.AppServices;
using Voucher.Application.ServiceStack.Interfaces;
using Voucher.Repository.Data;
using Microsoft.AspNetCore.Authentication.JwtBearer;
using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.HttpsPolicy;
using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion.Internal;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;
using Microsoft.Extensions.Logging;
using Microsoft.IdentityModel.Tokens;
using Microsoft.OpenApi.Any;
using Microsoft.OpenApi.Interfaces;
using Microsoft.OpenApi.Models;
using Newtonsoft.Json.Converters;
using Newtonsoft.Json.Serialization;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.IO;
using System.Linq;
using System.Reflection;
using System.Text;
using System.Threading.Tasks;

namespace Voucher.Api
{
    public class Startup
    {
        public Startup(IConfiguration configuration)
        {
            Configuration = configuration;
        }

        public IConfiguration Configuration { get; }
        
        // This method gets called by the runtime. Use this method to add services to the container.
        public void ConfigureServices(IServiceCollection services)
        {
            //Version
            FileVersionInfo info = FileVersionInfo.GetVersionInfo(Assembly.GetExecutingAssembly().Location);
            
            //MVC
            services.AddControllersWithViews().AddNewtonsoftJson(options =>
            {
                options.SerializerSettings.ContractResolver = new DefaultContractResolver()
                {
                    NamingStrategy = new CamelCaseNamingStrategy()
                };
            });

            //Swagger
            services.AddSwaggerGen(options =>
            {
                options.SwaggerDoc("v1", new OpenApiInfo
                {
                    Title = "Voucher Api",
                    Description = "",
                    Version = info.ProductVersion,
                    Extensions = new Dictionary<string, IOpenApiExtension>
                    {
                        {"x-logo", new OpenApiObject{
                            { "url",        new OpenApiString("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAADICAIAAABJdyC1AAAACXBIWXMAAAsTAAALEwEAmpwYAAA57mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzggNzkuMTU5ODI0LCAyMDE2LzA5LzE0LTAxOjA5OjAxICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgICAgICAgICB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIgogICAgICAgICAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICAgICAgICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoV2luZG93cyk8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgICAgPHhtcDpDcmVhdGVEYXRlPjIwMjAtMDYtMDVUMTY6NDA6MjQtMDM6MDA8L3htcDpDcmVhdGVEYXRlPgogICAgICAgICA8eG1wOk1ldGFkYXRhRGF0ZT4yMDIwLTA2LTA1VDE2OjQwOjI0LTAzOjAwPC94bXA6TWV0YWRhdGFEYXRlPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAyMC0wNi0wNVQxNjo0MDoyNC0wMzowMDwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXBNTTpJbnN0YW5jZUlEPnhtcC5paWQ6MjJkMzAwZDctYWZkZS0xODQ3LTg5MWUtOTI2ZGQzNjQ4ZmY0PC94bXBNTTpJbnN0YW5jZUlEPgogICAgICAgICA8eG1wTU06RG9jdW1lbnRJRD5hZG9iZTpkb2NpZDpwaG90b3Nob3A6NWU2Yzk4OWEtYTc2NC0xMWVhLWE2ZWEtYTYyZTZkZTI0N2NiPC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06T3JpZ2luYWxEb2N1bWVudElEPnhtcC5kaWQ6NzYyZWYzYzEtZjJhMS1mYjQwLTkzYzktMmFlMjI4Y2U2NTEwPC94bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpIaXN0b3J5PgogICAgICAgICAgICA8cmRmOlNlcT4KICAgICAgICAgICAgICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+Y3JlYXRlZDwvc3RFdnQ6YWN0aW9uPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6aW5zdGFuY2VJRD54bXAuaWlkOjc2MmVmM2MxLWYyYTEtZmI0MC05M2M5LTJhZTIyOGNlNjUxMDwvc3RFdnQ6aW5zdGFuY2VJRD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAyMC0wNi0wNVQxNjo0MDoyNC0wMzowMDwvc3RFdnQ6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgICAgICA8L3JkZjpsaT4KICAgICAgICAgICAgICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+c2F2ZWQ8L3N0RXZ0OmFjdGlvbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0Omluc3RhbmNlSUQ+eG1wLmlpZDoyMmQzMDBkNy1hZmRlLTE4NDctODkxZS05MjZkZDM2NDhmZjQ8L3N0RXZ0Omluc3RhbmNlSUQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDp3aGVuPjIwMjAtMDYtMDVUMTY6NDA6MjQtMDM6MDA8L3N0RXZ0OndoZW4+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpzb2Z0d2FyZUFnZW50PkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE3IChXaW5kb3dzKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNoYW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgPC9yZGY6bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpIaXN0b3J5PgogICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3BuZzwvZGM6Zm9ybWF0PgogICAgICAgICA8cGhvdG9zaG9wOkNvbG9yTW9kZT4zPC9waG90b3Nob3A6Q29sb3JNb2RlPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+NDAwPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjIwMDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3Ij8+Jtv/fQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAhv0lEQVR42uydZ3RTV7bHb1OXZbmOC5jQGXqMgdACoQ7whhoIPYSE8rLCW4GENFhkkplMKJMhyUDIkJAQeggM7Q0QWiBA6GB44AaYYgYDbrIsW+2W90HGBUu2LB1Zkv3/fWJh+cr33nP+Z+999tmbttlsFAAABAMMHgEAAIIFAAAQLAAABAsAACBYAAAAwQIAQLAAAACCBQAAECwAAAQLAAAgWAAAAMECAECwAAAAggUAABAsAAAECwAAIFgAAADBAgBAsAAAAIIFAAAQLAAABAsAACBYAAAAwQIAQLAAAACCBQAAECwAAAQLAAAgWAAACBYAAECwAAAAggUAgGABAAAECwAAIFgAAAgWAABAsAAAAIIFAIBgAQAABAsAACBYAAAIFgAAQLAAAACCBQCAYAEAAAQLAAAgWAAACBYAAECwAAAAggUAgGABAAAECwAAIFgAAAgWAABAsAAAAIIFAIBgAQAA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")},
                            { "altText",    new OpenApiString("Logo")}
                        }}
                    },
                });

                options.DocInclusionPredicate((docName, description) => true);
                options.EnableAnnotations();

                var xmlFile = $"{Assembly.GetExecutingAssembly().GetName().Name}.xml";
                var xmlPath = Path.Combine(AppContext.BaseDirectory, xmlFile);
                options.IncludeXmlComments(xmlPath);
            });

            services.AddDbContext<VoucherContext>();
            services.AddTransient<IEmailAppService, EmailAppService>();
            services.AddTransient<EmailRepository>();
            services.AddTransient<ITransportProviderAppService, TransportProviderAppService>();
            services.AddTransient<TransportProviderRepository>();
            services.AddTransient<IFoodProviderAppService, FoodProviderAppService>();
            services.AddTransient<FoodProviderRepository>();
            services.AddTransient<IAccommodationProviderAppService, AccommodationProviderAppService>();
            services.AddTransient<AccommodationProviderRepository>();
            services.AddTransient<IAccommodationVoucherAppService, AccommodationVoucherAppService>();
            services.AddTransient<AccommodationVoucherRepository>();
            services.AddTransient<IFoodVoucherAppService, FoodVoucherAppService>();
            services.AddTransient<FoodVoucherRepository>();
            services.AddTransient<ITransportVoucherAppService, TransportVoucherAppService>();
            services.AddTransient<TransportVoucherRepository>();
            services.AddTransient<ISpecialServiceAppService, SpecialServiceAppService>();
            services.AddTransient<SpecialServiceRepository>();
            services.AddTransient<AccommodationProviderSpecialServiceRepository>();
            services.AddTransient<ITrackingActiveDirectoryRepository, TrackingActiveDirectoryRepository>();
            services.AddTransient<IAirportAppService, AirportAppService>();
            services.AddTransient<AirportRepository>();
            services.AddTransient<ISabreDataRepository, SabreDataRepository>();
            services.AddTransient<ISabreRepository, SabreRepository>();
            services.AddTransient<AccommodationVacancyRepository>();
            services.AddTransient<IAccommodationVacancyAppService, AccommodationVacancyAppService>();
            services.AddTransient<VoucherIssuanceRestrictionRepository>();
            services.AddTransient<IVoucherIssuanceRestrictionAppService, VoucherIssuanceRestrictionAppService>();
            services.AddTransient<RemarksSabreRepository>();
            services.AddTransient<IRemarksSabreAppService, RemarksSabreAppService>();
            services.AddTransient<AccommodationProviderRepository>();
            services.AddTransient<IAccommodationProviderAppService, AccommodationProviderAppService>();
            services.AddTransient<ISendEmailService, SendEmailService>();
            services.AddTransient<FlightRepository>();
            services.AddTransient<IFlightAppService, FlightAppService>();
            services.AddTransient<IPassengerAppService, PassengerAppService>();
            services.AddTransient<PassengerRepository>();
            services.AddTransient<IPrintVoucherAppService, PrintVoucherAppService>();
            services.AddTransient<IReportVoucherAppService, ReportVoucherAppService>();

            //todo: identificar problema de https
            services.AddHttpClient<IADAppService, ADAppService>();

            services.AddControllers();

            services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme).AddJwtBearer(options =>
            {
                options.TokenValidationParameters = new TokenValidationParameters
                {
                    RequireExpirationTime = true,
                    ValidateIssuer = false,
                    ValidateAudience = false,
                    IssuerSigningKey = new SymmetricSecurityKey(Encoding.ASCII.GetBytes("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9"))
                };
                options.RequireHttpsMetadata = false;
            });
        }

        // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.
        public void Configure(IApplicationBuilder app, IWebHostEnvironment env)
        {
            app.UseAuthentication();

            app.UseCors(x => x.AllowAnyOrigin().AllowAnyMethod().AllowAnyHeader());

            if (env.IsDevelopment())
            {
                app.UseDeveloperExceptionPage();
            }
            else
            {
                app.UseHsts();
            }

            app.UseHttpsRedirection();

            app.UseRouting();

            app.UseAuthorization();

            app.UseEndpoints(endpoints =>
            {
                endpoints.MapControllers();
            });

            string subApplicationName = Configuration.GetSection("SubApplicationName").Value;

            app.UseSwaggerUI(setupAction =>
            {
                if (String.IsNullOrEmpty(subApplicationName))
                    setupAction.SwaggerEndpoint("/swagger/v1/swagger.json", "Voucher API");
                else
                    setupAction.SwaggerEndpoint($"/{subApplicationName}/swagger/v1/swagger.json", "Voucher API");

                setupAction.RoutePrefix = "";
            });

            app.UseSwagger();
            app.UseReDoc(c =>
            {
                c.SpecUrl("/swagger/v1/swagger.json");
                c.HideDownloadButton();
                c.HideLoading();
                c.SortPropsAlphabetically();
                c.ExpandResponses("200");
                c.RoutePrefix = "docs";
                c.IndexStream = () => Assembly.GetExecutingAssembly().GetManifestResourceStream("Gol.Voucher.Api.wwwroot.swagger.index.html");
            });
        }
    }
}
